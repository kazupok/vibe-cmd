# 開発用AIプロンプト集

## コード生成プロンプト

### ルール

- .konwledge配下の全てのフォルダとファイルを参照すること
- anyや曖昧な表現を避ける
- 他の実装が終わっていないので、曖昧になる場合などは`TODO: `でコメントを残すこと
- 実装が終わったら必ず`pnpm test`, `pnpm build`, `pnpm check-types`,`pnpm lint` を実行し、エラーが出た場合は修正すること

### エンティティ作成

```
MaterCMSプロジェクトのDDD設計に従って、[エンティティ名]エンティティを作成してください。

要件：
- packages/core/src/[ドメイン名]/entities/に配置
- 基底クラスEntityを継承
- 値オブジェクトを使用
- ファクトリメソッドパターン（create/reconstitute）
- Resultパターンでエラーハンドリング
- 適切なゲッターとビジネスロジック
- toPersistenceメソッドでシリアライズ

含めるプロパティ：
- [プロパティリスト]

ビジネスルール：
- [ルールリスト]
```

### 値オブジェクト作成

```
MaterCMSプロジェクトの値オブジェクトを作成してください。

要件：
- ValueObject基底クラスを継承
- イミュータブルな実装
- 検証ロジックを含む
- Resultパターンで作成
- 適切なヘルパーメソッド

値オブジェクト名: [名前]
保持する値の型: [型]
検証ルール:
- [ルールリスト]
```

### リポジトリ実装

```
[エンティティ名]のリポジトリ実装を作成してください。

要件：
- インターフェースと実装を分離
- PostgreSQL用の実装
- トランザクション対応
- エラーハンドリング
- ページネーション対応（必要に応じて）

必要なメソッド：
- findById
- findBy[条件]
- save（upsert）
- delete（論理削除）
- [その他カスタムメソッド]
```

### APIエンドポイント作成

```
[リソース名]のREST APIエンドポイントを実装してください。

要件：
- Express.jsルーター
- 適切なHTTPメソッドとステータスコード
- 入力検証（Zod使用）
- エラーハンドリング
- 認証・認可チェック
- レスポンス形式はプロジェクト標準に準拠

エンドポイント：
- GET /[リソース]
- GET /[リソース]/:id
- POST /[リソース]
- PATCH /[リソース]/:id
- DELETE /[リソース]/:id
```

### テストコード生成

```
[クラス/関数名]のユニットテストを作成してください。

要件：
- Vitestを使用
- describe/it構造
- 日本語でテストケースを記述
- Arrange-Act-Assertパターン
- 正常系と異常系を網羅
- モックは最小限に
- エッジケースを考慮

テスト対象の主な機能：
- [機能リスト]
```

## リファクタリングプロンプト

### パフォーマンス改善

```
以下のコードのパフォーマンスを改善してください：

[コード]

考慮事項：
- N+1問題の解決
- 不要なデータ取得の削減
- キャッシュの活用
- 並列処理の可能性
- データベースクエリの最適化
```

### コード品質改善

```
以下のコードをリファクタリングしてください：

[コード]

改善ポイント：
- SOLID原則の適用
- 重複コードの除去
- 可読性の向上
- エラーハンドリングの改善
- 型安全性の強化
```

### セキュリティ強化

```
以下のコードのセキュリティを強化してください：

[コード]

チェックポイント：
- 入力検証
- SQLインジェクション対策
- XSS対策
- 認証・認可
- 機密情報の取り扱い
- ログ出力の適正化
```

## デバッグ支援プロンプト

### エラー解析

```
以下のエラーの原因と解決方法を教えてください：

エラーメッセージ：
[エラー内容]

コンテキスト：
- 実行環境: [環境]
- 関連コード: [コード]
- 実行手順: [手順]

期待される動作：
[説明]
```

### パフォーマンス分析

```
以下のパフォーマンスプロファイルを分析してください：

[プロファイル結果]

分析してほしい点：
- ボトルネックの特定
- 改善可能な箇所
- 推奨される最適化手法
- 実装の優先順位
```

## アーキテクチャ設計プロンプト

### 機能設計

```
[機能名]の設計を提案してください。

要件：
- [機能要件リスト]

制約：
- MaterCMSの既存アーキテクチャに準拠
- DDDの原則に従う
- 既存のドメインモデルを活用
- スケーラビリティを考慮

提案に含めてほしい内容：
- ドメインモデル
- ユースケース
- API設計
- データベース設計
- 実装の順序
```

### 統合設計

```
[外部サービス名]との統合を設計してください。

要件：
- [統合要件]

考慮事項：
- レート制限
- エラーハンドリング
- データ同期
- 認証方式
- モニタリング

提案する実装：
- アダプターパターンの使用
- 非同期処理の設計
- フォールバック戦略
```

## ドキュメント生成プロンプト

### API仕様書

```
[エンドポイント名]のOpenAPI仕様を生成してください。

含める内容：
- パスパラメータ
- クエリパラメータ
- リクエストボディ
- レスポンス形式
- エラーレスポンス
- 認証要件
- 使用例
```

### README作成

```
[パッケージ/機能名]のREADMEを作成してください。

セクション：
- 概要
- インストール方法
- 使用方法
- API リファレンス
- 設定オプション
- 例
- トラブルシューティング
- 貢献方法
```

## コードレビュープロンプト

### 包括的レビュー

```
以下のプルリクエストをレビューしてください：

[コード差分]

レビュー観点：
- 機能要件の充足
- コーディング規約の遵守
- パフォーマンスへの影響
- セキュリティリスク
- テストカバレッジ
- ドキュメントの更新
- 後方互換性

フィードバック形式：
- 問題点と改善提案
- 良い実装の指摘
- 質問事項
```

### セキュリティレビュー

```
以下のコードのセキュリティレビューを実施してください：

[コード]

OWASP Top 10に基づいてチェック：
- インジェクション
- 認証の不備
- 機密データの露出
- XML外部エンティティ（XXE）
- アクセス制御の不備
- セキュリティ設定のミス
- XSS
- 安全でないデシリアライゼーション
- 既知の脆弱性を持つコンポーネント
- 不十分なロギングとモニタリング
```

## 最適化プロンプト

### データベースクエリ最適化

```
以下のクエリを最適化してください：

[SQLクエリまたはORMコード]

現在のパフォーマンス：
- 実行時間: [時間]
- 影響する行数: [行数]

最適化の方向性：
- インデックスの追加
- クエリの書き換え
- 非正規化の検討
- キャッシュ戦略
```

### バンドルサイズ削減

```
フロントエンドのバンドルサイズを削減する方法を提案してください。

現在の状況：
- バンドルサイズ: [サイズ]
- 使用ライブラリ: [リスト]

webpack-bundle-analyzer結果：
[結果]

削減目標: [目標サイズ]
```
