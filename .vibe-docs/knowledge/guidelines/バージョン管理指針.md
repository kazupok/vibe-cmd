# バージョニングガイドライン

## 概要

プロジェクトの新しいバージョンリリース時のドキュメント作成手順を定義します。

## バージョン種別の判断

### メジャーバージョン（v2.0, v3.0）

- 大幅な仕様変更
- 後方互換性なし
- アーキテクチャの根本的変更
- 既存APIの廃止・大幅変更

### マイナーバージョン（v1.1, v1.2）

- 新機能の追加
- 後方互換性あり
- 既存機能の拡張
- 新しいAPIエンドポイント追加

### パッチバージョン（v1.1.1, v1.1.2）

- バグフィックス
- セキュリティパッチ
- 軽微な修正
- 後方互換性あり

## 事前準備

### 1. 前バージョンの確認

```bash
# 現在のバージョンを確認
ls docs/
# 最新バージョンの内容を確認
ls docs/v[最新バージョン]/
```

### 2. 変更要件の整理

- [ ] 新機能・変更点のリスト作成
- [ ] 削除・廃止予定機能の確認
- [ ] 互換性への影響評価
- [ ] 移行ガイドの必要性判断

## 新バージョン作成手順

### Step 1: ブランチ作成

```bash
# 新しいバージョン用ブランチを作成
git checkout -b docs/v[新バージョン]

# 例: git checkout -b docs/v1.2
```

### Step 2: ディレクトリ準備

```bash
# 前バージョンのディレクトリをコピー
cp -r docs/v[前バージョン] docs/v[新バージョン]

# 例: cp -r docs/v1.1 docs/v1.2
```

### Step 3: バージョン情報更新

各ドキュメントファイルのヘッダーを更新：

```markdown
# [ドキュメント名] v[新バージョン]

**バージョン情報**

- バージョン：v[新バージョン]
- 初版作成日：[今日の日付]
- 最終更新日：[今日の日付]
- 前バージョン：v[前バージョン]
- ステータス：Draft
```

### Step 4: 修正履歴リセット

既存の修正履歴テーブルを初期化し、初版エントリーのみ残す：

```markdown
## 修正履歴

| 日付         | バージョン      | 修正者     | 修正内容 | 影響範囲 |
| ------------ | --------------- | ---------- | -------- | -------- |
| [今日の日付] | v[新バージョン] | [作成者名] | 初版作成 | 全体     |
```

### Step 5: 変更内容の反映

#### 新機能追加の場合

- 該当セクションに新しい内容を追加
- 目次を更新
- 関連する他のドキュメントとの整合性確認

#### 仕様変更の場合

- 変更箇所を特定して更新
- **変更点**セクションを追加（一時的）
- 前バージョンとの違いを明記

#### 削除・廃止の場合

- 該当セクションを削除
- **廃止された機能**セクションを追加
- 代替手段があれば記載

### Step 6: 品質チェック

#### 内容チェック

- [ ] 技術的内容の正確性
- [ ] 新機能の説明完全性
- [ ] サンプルコードの動作確認
- [ ] 用語の一貫性

#### 構造チェック

- [ ] 目次の自動生成・更新
- [ ] 内部リンクの確認
- [ ] 外部リンクの有効性
- [ ] 画像・図表の表示確認

#### バージョン管理チェック

- [ ] バージョン番号の一貫性
- [ ] 日付の正確性
- [ ] 前バージョンとの差分明確化
- [ ] ステータス情報の適切性

### Step 7: レビュー依頼

#### プルリクエスト作成

```markdown
## 新バージョンドキュメント作成

**バージョン情報**

- 新バージョン: v[X.Y]
- 前バージョン: v[X.Y-1]
- リリース予定日: [日付]

**主な変更点**

- [ ] 新機能: [機能名]
- [ ] 仕様変更: [変更内容]
- [ ] 廃止機能: [機能名]

**更新ファイル**

- [ ] specification.md
- [ ] api-reference.md
- [ ] user-guide.md
- [ ] [その他]

**確認項目**

- [ ] バージョン情報が正しく更新されている
- [ ] 新機能の説明が完全である
- [ ] 変更点が明確に示されている
- [ ] 他のドキュメントとの整合性が取れている
- [ ] リンクが正しく動作する

**移行ガイド必要性**

- [ ] 必要 / [ ] 不要
- 理由: [記載]
```

### Step 8: 承認後の処理

#### マージ準備

```bash
# 最終確認
git status
git add .
git commit -m "docs(v[新バージョン]): feat 新バージョンドキュメント作成"
```

#### メインブランチへのマージ

```bash
git checkout main
git merge docs/v[新バージョン]
git tag v[新バージョン]-docs
git push origin main --tags
```

## 移行ガイド作成

### 必要な場合

- 重大な仕様変更がある
- APIの破壊的変更がある
- 設定ファイル形式の変更がある
- 依存関係の大幅変更がある

### 移行ガイドテンプレート

```markdown
# v[前バージョン] から v[新バージョン] への移行ガイド

## 概要

[移行の必要性と影響範囲]

## 重要な変更点

### 破壊的変更

- [変更点1]
- [変更点2]

### 非推奨機能

- [機能名]: v[廃止予定バージョン]で削除予定

## 移行手順

### 1. [手順名]

[詳細な手順]

### 2. [手順名]

[詳細な手順]

## トラブルシューティング

### よくある問題

- **問題**: [問題の説明]
  **解決**: [解決方法]

## サポート

移行に関する質問は[連絡先]まで
```

## 完了後の作業

### ドキュメントサイト更新

- [ ] 最新バージョンへのリンク更新
- [ ] バージョン選択UI更新
- [ ] 検索インデックス更新

### 通知・周知

- [ ] チーム内への新バージョン完成通知
- [ ] ユーザー向けリリースノート準備
- [ ] 外部ドキュメントサイトへの反映

### アーカイブ処理

- [ ] 古いバージョンのステータス更新
- [ ] EOLバージョンのアーカイブ化
- [ ] ブランチの整理

## AIプロンプト活用

新バージョン作成時に使用するプロンプト例：

```
新しいバージョンのドキュメントを作成してください：

**バージョン情報：**
- 新バージョン：v[X.Y]
- 前バージョン：v[X.Y-1]
- リリース日：[日付]

**主な変更点：**
[変更内容のリスト]

**既存ドキュメント：**
[前バージョンのドキュメント内容]

**要件：**
1. バージョン情報ヘッダーの更新
2. 変更点の反映
3. 修正履歴の初期化
4. 目次の更新
5. 前バージョンとの差分明確化

完全なMarkdownドキュメントと変更点の説明を提供してください。
```
